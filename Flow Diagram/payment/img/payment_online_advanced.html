<!-- Edits:
1) line 13/14 changed the dataflow diagram png
2) line 20, changed the fourth item {item.data} to {item.?} (determined from line 957 /usr/local/lib/python3.9/site-packages/pytm/pytm.py) -->
<h1 id="threat-model-sample">Threat Model Sample</h1>
<hr />
<h2 id="system-description">System Description</h2>
<p>stripe payment</p>
<h2 id="dataflow-diagram">Dataflow Diagram</h2>
<!-- ![Level 0 DFD](dfd.png) -->
<figure>
<img src="../img/payment_online.png" alt="Initial payment flow diagram" /><figcaption aria-hidden="true">Initial payment flow diagram</figcaption>
</figure>
<h2 id="dataflows">Dataflows</h2>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 11%" />
<col style="width: 14%" />
<col style="width: 29%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>From</th>
<th>To</th>
<th>Data</th>
<th>Protocol</th>
<th>Port</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Customer logs into the merchant site (*)</td>
<td>Customer</td>
<td>Customer Client</td>
<td>DataSet({&lt;pytm.pytm.Data(OAuth) at 0x10bae03a0&gt;})</td>
<td>HTTPS</td>
<td>443</td>
</tr>
<tr class="even">
<td>Customer proceeds to payment page to make a purchase (*)</td>
<td>Customer</td>
<td>Customer Client</td>
<td>[]</td>
<td>HTTPS</td>
<td>443</td>
</tr>
<tr class="odd">
<td>Customer Client sends order intent, including order amount (*)</td>
<td>Customer Client</td>
<td>Merchant Web Server</td>
<td>[]</td>
<td>HTTPS</td>
<td>443</td>
</tr>
<tr class="even">
<td>Merchant sends order information inc amount and currency (*)</td>
<td>Merchant Web Server</td>
<td>Stripe API service</td>
<td>DataSet({&lt;pytm.pytm.Data(POST /v1/payment_intents) at 0x10bae0580&gt;})</td>
<td></td>
<td>-1</td>
</tr>
<tr class="odd">
<td>Return PaymentIntent to the Merchant (*)</td>
<td>Stripe API service</td>
<td>Merchant Web Server</td>
<td>DataSet({&lt;pytm.pytm.Data(Response) at 0x10bae0640&gt;})</td>
<td></td>
<td>-1</td>
</tr>
<tr class="even">
<td>Return PaymentIntent to the Customer Client (*)</td>
<td>Merchant Web Server</td>
<td>Customer Client</td>
<td>DataSet({&lt;pytm.pytm.Data(merchant_secret) at 0x10bae0700&gt;})</td>
<td></td>
<td>-1</td>
</tr>
<tr class="odd">
<td>Customer provides card details and finalizes payment (*)</td>
<td>Customer</td>
<td>Customer Client</td>
<td>[]</td>
<td></td>
<td>-1</td>
</tr>
<tr class="even">
<td>Customer Client sends stripe.confirmCardPayment() (*)</td>
<td>Customer Client</td>
<td>Stripe API service</td>
<td>DataSet({&lt;pytm.pytm.Data(client_secret and card details) at 0x10bae0850&gt;})</td>
<td></td>
<td>-1</td>
</tr>
<tr class="odd">
<td>Attempt payment</td>
<td>Stripe API service</td>
<td>Stripe Payment Service</td>
<td>[]</td>
<td></td>
<td>-1</td>
</tr>
<tr class="even">
<td>Payment Response</td>
<td>Stripe Payment Service</td>
<td>Stripe API service</td>
<td>[]</td>
<td></td>
<td>-1</td>
</tr>
<tr class="odd">
<td>Return the PaymentIntent with status (*)</td>
<td>Stripe API service</td>
<td>Customer Client</td>
<td>DataSet({&lt;pytm.pytm.Data(Return the PaymentIntent with status ‘succeeded’) at 0x10bae0a30&gt;})</td>
<td></td>
<td>-1</td>
</tr>
</tbody>
</table>
<h2 id="findings">Findings</h2>
<h3 id="merchant-web-server">Merchant Web Server</h3>
<p><strong>Threat</strong>: INP03 - Server Side Include (SSI) Injection</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Set the OPTIONS IncludesNOEXEC in the global access.conf file or local .htaccess (Apache) file to deny SSI execution in directories that do not need them. All user controllable input must be appropriately sanitized before use in the application. This includes omitting, or encoding, certain characters or strings that have the potential of being interpreted as part of an SSI directive. Server Side Includes must be enabled only if there is a strong business reason to do so. Every additional component enabled on the web server increases the attack surface as well as administrative overhead.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/101.html, http://cwe.mitre.org/data/definitions/97.html, http://cwe.mitre.org/data/definitions/74.html, http://cwe.mitre.org/data/definitions/20.html, http://cwe.mitre.org/data/definitions/713.html</p>
<p><strong>Threat</strong>: INP05 - Command Line Execution through SQL Injection</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: Disable MSSQL xp_cmdshell directive on the databaseProperly validate the data (syntactically and semantically) before writing it to the database. Do not implicitly trust the data stored in the database. Re-validate it prior to usage to make sure that it is safe to use in a given context (e.g. as a command line argument).</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/108.html, http://cwe.mitre.org/data/definitions/89.html, http://cwe.mitre.org/data/definitions/74.html, http://cwe.mitre.org/data/definitions/20.html, http://cwe.mitre.org/data/definitions/78.html, http://cwe.mitre.org/data/definitions/114.html</p>
<p><strong>Threat</strong>: AA01 - Authentication Abuse/ByPass</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication and authorization mechanisms. A proven protocol is OAuth 2.0, which enables a third-party application to obtain limited access to an API.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/114.html, http://cwe.mitre.org/data/definitions/287.html</p>
<p><strong>Threat</strong>: DS01 - Excavation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Minimize error/response output to only what is necessary for functional use or corrective language. Remove potentially sensitive information that is not necessary for the application’s functionality.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/116.html, http://cwe.mitre.org/data/definitions/200.html</p>
<p><strong>Threat</strong>: DE02 - Double Encoding</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Assume all input is malicious. Create a white list that defines all valid input to the software system based on the requirements specifications. Input that does not match against the white list should not be permitted to enter into the system. Test your decoding process against malicious input. Be aware of the threat of alternative method of data encoding and obfuscation technique such as IP address encoding. When client input is required from web-based forms, avoid using the GET method to submit data, as the method causes the form data to be appended to the URL and is easily manipulated. Instead, use the POST method whenever possible. Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process.Refer to the RFCs to safely decode URL. Regular expression can be used to match safe URL patterns. However, that may discard valid URL requests if the regular expression is too restrictive. There are tools to scan HTTP requests to the server for valid URL such as URLScan from Microsoft (http://www.microsoft.com/technet/security/tools/urlscan.mspx).</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/120.html, http://cwe.mitre.org/data/definitions/173.html, http://cwe.mitre.org/data/definitions/177.html</p>
<p><strong>Threat</strong>: AC01 - Privilege Abuse</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication and authorization mechanisms. A proven protocol is OAuth 2.0, which enables a third-party application to obtain limited access to an API.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/122.html, http://cwe.mitre.org/data/definitions/732.html, http://cwe.mitre.org/data/definitions/269.html</p>
<p><strong>Threat</strong>: DO01 - Flooding</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Ensure that protocols have specific limits of scale configured. Specify expectations for capabilities and dictate which behaviors are acceptable when resource allocation reaches limits. Uniformly throttle all requests in order to make it more difficult to consume resources more quickly than they can again be freed.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/125.html, http://cwe.mitre.org/data/definitions/404.html, http://cwe.mitre.org/data/definitions/770.html</p>
<p><strong>Threat</strong>: HA01 - Path Traversal</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: Design: Configure the access control correctly. Design: Enforce principle of least privilege. Design: Execute programs with constrained privileges, so parent process does not open up further vulnerabilities. Ensure that all directories, temporary directories and files, and memory are executing with limited privileges to protect against remote execution. Design: Input validation. Assume that user inputs are malicious. Utilize strict type, character, and encoding enforcement. Design: Proxy communication to host, so that communications are terminated at the proxy, sanitizing the requests before forwarding to server host. 6. Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands. Implementation: Host integrity monitoring for critical files, directories, and processes. The goal of host integrity monitoring is to be aware when a security issue has occurred so that incident response and other forensic activities can begin. Implementation: Perform input validation for all remote content, including remote and user-generated content. Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables. Implementation: Use indirect references rather than actual file names. Implementation: Use possible permissions on file access when developing and deploying web applications. Implementation: Validate user input by only accepting known good. Ensure all content that is delivered to client is sanitized against an acceptable content specification – whitelisting approach.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/126.html, http://cwe.mitre.org/data/definitions/22.html</p>
<p><strong>Threat</strong>: DO02 - Excessive Allocation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Limit the amount of resources that are accessible to unprivileged users. Assume all input is malicious. Consider all potentially relevant properties when validating input. Consider uniformly throttling all requests in order to make it more difficult to consume resources more quickly than they can again be freed. Use resource-limiting settings, if possible.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/130.html, http://cwe.mitre.org/data/definitions/770.html, http://cwe.mitre.org/data/definitions/404.html</p>
<p><strong>Threat</strong>: INP08 - Format String Injection</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Limit the usage of formatting string functions. Strong input validation - All user-controllable input must be validated and filtered for illegal formatting characters.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/135.html, http://cwe.mitre.org/data/definitions/134.html, http://cwe.mitre.org/data/definitions/133.html</p>
<p><strong>Threat</strong>: INP09 - LDAP Injection</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Strong input validation - All user-controllable input must be validated and filtered for illegal characters as well as LDAP content. Use of custom error pages - Attackers can glean information about the nature of queries from descriptive error messages. Input validation must be coupled with customized error pages that inform about an error without disclosing information about the LDAP or application.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/136.html, http://cwe.mitre.org/data/definitions/77.html, http://cwe.mitre.org/data/definitions/90.html, http://cwe.mitre.org/data/definitions/20.html</p>
<p><strong>Threat</strong>: INP10 - Parameter Injection</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Implement an audit log written to a separate host. In the event of a compromise, the audit log may be able to provide evidence and details of the compromise. Treat all user input as untrusted data that must be validated before use.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/137.html, http://cwe.mitre.org/data/definitions/88.html</p>
<p><strong>Threat</strong>: INP11 - Relative Path Traversal</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: Input validation. Assume that user inputs are malicious. Utilize strict type, character, and encoding enforcement. Implementation: Perform input validation for all remote content, including remote and user-generated content. Implementation: Validate user input by only accepting known good. Ensure all content that is delivered to client is sanitized against an acceptable content specification – whitelisting approach. Implementation: Prefer working without user input when using file system calls. Implementation: Use indirect references rather than actual file names. Implementation: Use possible permissions on file access when developing and deploying web applications.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/139.html, http://cwe.mitre.org/data/definitions/23.html</p>
<p><strong>Threat</strong>: AC05 - Content Spoofing</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Validation of user input for type, length, data-range, format, etc. Encoding any user input that will be output by the web application.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/148.html, http://cwe.mitre.org/data/definitions/345.html</p>
<p><strong>Threat</strong>: INP14 - Input Data Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Validation of user input for type, length, data-range, format, etc.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/153.html, http://cwe.mitre.org/data/definitions/20.html</p>
<p><strong>Threat</strong>: CR03 - Dictionary-based Password Attack</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Create a strong password policy and ensure that your system enforces this policy.Implement an intelligent password throttling mechanism. Care must be taken to assure that these mechanisms do not excessively enable account lockout attacks such as CAPEC-02.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/16.html, http://cwe.mitre.org/data/definitions/521.html, http://cwe.mitre.org/data/definitions/262.html, http://cwe.mitre.org/data/definitions/263.html</p>
<p><strong>Threat</strong>: AC06 - Using Malicious Files</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: Design: Enforce principle of least privilegeDesign: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/17.html, http://cwe.mitre.org/data/definitions/732.html, http://cwe.mitre.org/data/definitions/272.html, http://cwe.mitre.org/data/definitions/270.html</p>
<p><strong>Threat</strong>: HA03 - Web Application Fingerprinting</p>
<p><strong>Severity</strong>: Low</p>
<p><strong>Mitigations</strong>: Implementation: Obfuscate server fields of HTTP response.Implementation: Hide inner ordering of HTTP response header.Implementation: Customizing HTTP error codes such as 404 or 500.Implementation: Hide URL file extension.Implementation: Hide HTTP response header software information filed.Implementation: Hide cookie’s software information filed.Implementation: Appropriately deal with error messages.Implementation: Obfuscate database type in Database API’s error message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/170.html, http://cwe.mitre.org/data/definitions/497.html</p>
<p><strong>Threat</strong>: SC02 - XSS Targeting Non-Script Elements</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: In addition to the traditional input fields, all other user controllable inputs, such as image tags within messages or the likes, must also be subjected to input validation. Such validation should ensure that content that can be potentially interpreted as script by the browser is appropriately filtered.All output displayed to clients must be properly escaped. Escaping ensures that the browser interprets special scripting characters literally and not as script to be executed.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/18.html, http://cwe.mitre.org/data/definitions/80.html</p>
<p><strong>Threat</strong>: AC07 - Exploiting Incorrectly Configured Access Control Security Levels</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Design: Configure the access control correctly.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/180.html, http://cwe.mitre.org/data/definitions/732.html</p>
<p><strong>Threat</strong>: SC03 - Embedding Scripts within Scripts</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Use browser technologies that do not allow client side scripting.Utilize strict type, character, and encoding enforcement.Server side developers should not proxy content via XHR or other means. If a HTTP proxy for remote content is setup on the server side, the client’s browser has no way of discerning where the data is originating from.Ensure all content that is delivered to client is sanitized against an acceptable content specification.Perform input validation for all remote content.Perform output validation for all remote content.Disable scripting languages such as JavaScript in browserSession tokens for specific hostPatching software. There are many attack vectors for XSS on the client side and the server side. Many vulnerabilities are fixed in service packs for browser, web servers, and plug in technologies, staying current on patch release that deal with XSS countermeasures mitigates this.Privileges are constrained, if a script is loaded, ensure system runs in chroot jail or other limited authority mode</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/19.html, http://cwe.mitre.org/data/definitions/284.html</p>
<p><strong>Threat</strong>: INP16 - PHP Remote File Inclusion</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Implementation: Perform input validation for all remote content, including remote and user-generated contentImplementation: Only allow known files to be included (whitelist)Implementation: Make use of indirect references passed in URL parameters instead of file namesConfiguration: Ensure that remote scripts cannot be include in the include or require PHP directives</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/193.html, http://cwe.mitre.org/data/definitions/98.html, http://cwe.mitre.org/data/definitions/80.html, http://cwe.mitre.org/data/definitions/714.html</p>
<p><strong>Threat</strong>: AA02 - Principal Spoof</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Employ robust authentication processes (e.g., multi-factor authentication).</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/195.html</p>
<p><strong>Threat</strong>: DS04 - XSS Targeting Error Pages</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Design: Use libraries and templates that minimize unfiltered input.Implementation: Normalize, filter and white list any input that will be used in error messages.Implementation: The victim should configure the browser to minimize active content from untrusted sources.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/198.html, http://cwe.mitre.org/data/definitions/81.html</p>
<p><strong>Threat</strong>: SC04 - XSS Using Alternate Syntax</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: Use browser technologies that do not allow client side scripting.Design: Utilize strict type, character, and encoding enforcementImplementation: Ensure all content that is delivered to client is sanitized against an acceptable content specification.Implementation: Ensure all content coming from the client is using the same encoding; if not, the server-side application must canonicalize the data before applying any filtering.Implementation: Perform input validation for all remote content, including remote and user-generated contentImplementation: Perform output validation for all remote content.Implementation: Disable scripting languages such as JavaScript in browserImplementation: Patching software. There are many attack vectors for XSS on the client side and the server side. Many vulnerabilities are fixed in service packs for browser, web servers, and plug in technologies, staying current on patch release that deal with XSS countermeasures mitigates this.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/199.html, http://cwe.mitre.org/data/definitions/87.html</p>
<p><strong>Threat</strong>: CR05 - Encryption Brute Forcing</p>
<p><strong>Severity</strong>: Low</p>
<p><strong>Mitigations</strong>: Use commonly accepted algorithms and recommended key sizes. The key size used will depend on how important it is to keep the data confidential and for how long.In theory a brute force attack performing an exhaustive key space search will always succeed, so the goal is to have computational security. Moore’s law needs to be taken into account that suggests that computing resources double every eighteen months.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/20.html, http://cwe.mitre.org/data/definitions/326.html, http://cwe.mitre.org/data/definitions/327.html, http://cwe.mitre.org/data/definitions/693.html, http://cwe.mitre.org/data/definitions/719.html</p>
<p><strong>Threat</strong>: AC08 - Manipulate Registry Information</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Ensure proper permissions are set for Registry hives to prevent users from modifying keys.Employ a robust and layered defensive posture in order to prevent unauthorized users on your system.Employ robust identification and audit/blocking via whitelisting of applications on your system. Unnecessary applications, utilities, and configurations will have a presence in the system registry that can be leveraged by an adversary through this attack pattern.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/203.html, http://cwe.mitre.org/data/definitions/15.html</p>
<p><strong>Threat</strong>: SC05 - Removing Important Client Functionality</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: For any security checks that are performed on the client side, ensure that these checks are duplicated on the server side.Design: Ship client-side application with integrity checks (code signing) when possible.Design: Use obfuscation and other techniques to prevent reverse engineering the client code.</p>
<p><strong>References</strong>: http://cwe.mitre.org/data/definitions/602.html</p>
<p><strong>Threat</strong>: INP17 - XSS Using MIME Type Mismatch</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Design: Browsers must invoke script filters to detect that the specified MIME type of the file matches the actual type of its content before deciding which script interpreter to use.</p>
<p><strong>References</strong>: http://cwe.mitre.org/data/definitions/79.html, http://cwe.mitre.org/data/definitions/20.html, http://cwe.mitre.org/data/definitions/646.html</p>
<p><strong>Threat</strong>: AA03 - Exploitation of Trusted Credentials</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: utilize strong federated identity such as SAML to encrypt and sign identity tokens in transit.Implementation: Use industry standards session key generation mechanisms that utilize high amount of entropy to generate the session key. Many standard web and application servers will perform this task on your behalf.Implementation: If the session identifier is used for authentication, such as in the so-called single sign on use cases, then ensure that it is protected at the same level of assurance as authentication tokens.Implementation: If the web or application server supports it, then encrypting and/or signing the session ID (such as cookie) can protect the ID if intercepted.Design: Use strong session identifiers that are protected in transit and at rest.Implementation: Utilize a session timeout for all sessions, for example 20 minutes. If the user does not explicitly logout, the server terminates their session after this period of inactivity. If the user logs back in then a new session key is generated.Implementation: Verify of authenticity of all session IDs at runtime.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/21.html, http://cwe.mitre.org/data/definitions/290.html, http://cwe.mitre.org/data/definitions/346.html, http://cwe.mitre.org/data/definitions/664.html</p>
<p><strong>Threat</strong>: AC09 - Functionality Misuse</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Perform comprehensive threat modeling, a process of identifying, evaluating, and mitigating potential threats to the application. This effort can help reveal potentially obscure application functionality that can be manipulated for malicious purposes.When implementing security features, consider how they can be misused and compromised.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/212.html</p>
<p><strong>Threat</strong>: INP18 - Fuzzing and observing application log data/errors for application mapping</p>
<p><strong>Severity</strong>: Low</p>
<p><strong>Mitigations</strong>: Design: Construct a ‘code book’ for error messages. When using a code book, application error messages aren’t generated in string or stack trace form, but are catalogued and replaced with a unique (often integer-based) value ‘coding’ for the error. Such a technique will require helpdesk and hosting personnel to use a ‘code book’ or similar mapping to decode application errors/logs in order to respond to them normally.Design: wrap application functionality (preferably through the underlying framework) in an output encoding scheme that obscures or cleanses error messages to prevent such attacks. Such a technique is often used in conjunction with the above ‘code book’ suggestion.Implementation: Obfuscate server fields of HTTP response.Implementation: Hide inner ordering of HTTP response header.Implementation: Customizing HTTP error codes such as 404 or 500.Implementation: Hide HTTP response header software information filed.Implementation: Hide cookie’s software information filed.Implementation: Obfuscate database type in Database API’s error message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/215.html, http://cwe.mitre.org/data/definitions/209.html, http://cwe.mitre.org/data/definitions/532.html</p>
<p><strong>Threat</strong>: AC10 - Exploiting Incorrectly Configured SSL</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Usage of configuration settings, such as stream ciphers vs. block ciphers and setting timeouts on SSL sessions to extremely low values lessens the potential impact. Use of later versions of TLS (e.g. TLS 1.1+) can also be effective, but not all clients or servers support the later versions.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/217.html, http://cwe.mitre.org/data/definitions/201.html</p>
<p><strong>Threat</strong>: AA04 - Exploiting Trust in Client</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: Ensure that client process and/or message is authenticated so that anonymous communications and/or messages are not accepted by the system.Design: Do not rely on client validation or encoding for security purposes.Design: Utilize digital signatures to increase authentication assurance.Design: Utilize two factor authentication to increase authentication assurance.Implementation: Perform input validation for all remote content.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/22.html, http://cwe.mitre.org/data/definitions/287.html</p>
<p><strong>Threat</strong>: INP19 - XML External Entities Blowup</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: This attack may be mitigated by tweaking the XML parser to not resolve external entities. If external entities are needed, then implement a custom XmlResolver that has a request timeout, data retrieval limit, and restrict resources it can retrieve locally.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/221.html, http://cwe.mitre.org/data/definitions/611.html</p>
<p><strong>Threat</strong>: AC11 - Session Credential Falsification through Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Implementation: Use session IDs that are difficult to guess or brute-force: One way for the attackers to obtain valid session IDs is by brute-forcing or guessing them. By choosing session identifiers that are sufficiently random, brute-forcing or guessing becomes very difficult. Implementation: Regenerate and destroy session identifiers when there is a change in the level of privilege: This ensures that even though a potential victim may have followed a link with a fixated identifier, a new one is issued when the level of privilege changes.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/226.html, http://cwe.mitre.org/data/definitions/565.html, http://cwe.mitre.org/data/definitions/472.html</p>
<p><strong>Threat</strong>: INP21 - DTD Injection</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Design: Sanitize incoming DTDs to prevent excessive expansion or other actions that could result in impacts like resource depletion.Implementation: Disallow the inclusion of DTDs as part of incoming messages.Implementation: Use XML parsing tools that protect against DTD attacks.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/228.html, http://cwe.mitre.org/data/definitions/829.html</p>
<p><strong>Threat</strong>: INP22 - XML Attribute Blowup</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: This attack may be mitigated completely by using a parser that is not using a vulnerable container. Mitigation may also limit the number of attributes per XML element.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/229.html, http://cwe.mitre.org/data/definitions/770.html</p>
<p><strong>Threat</strong>: INP28 - XSS Targeting URI Placeholders</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: Use browser technologies that do not allow client side scripting.Design: Utilize strict type, character, and encoding enforcement.Implementation: Ensure all content that is delivered to client is sanitized against an acceptable content specification.Implementation: Ensure all content coming from the client is using the same encoding; if not, the server-side application must canonicalize the data before applying any filtering.Implementation: Perform input validation for all remote content, including remote and user-generated contentImplementation: Perform output validation for all remote content.Implementation: Disable scripting languages such as JavaScript in browserImplementation: Patching software. There are many attack vectors for XSS on the client side and the server side. Many vulnerabilities are fixed in service packs for browser, web servers, and plug in technologies, staying current on patch release that deal with XSS countermeasures mitigates this.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/244.html, http://cwe.mitre.org/data/definitions/83.html</p>
<p><strong>Threat</strong>: INP29 - XSS Using Doubled Characters</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Design: Use libraries and templates that minimize unfiltered input.Implementation: Normalize, filter and sanitize all user supplied fields.Implementation: The victim should configure the browser to minimize active content from untrusted sources.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/245.html</p>
<p><strong>Threat</strong>: INP34 - SOAP Array Overflow</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: If the server either verifies the correctness of the stated array size or if the server stops processing an array once the stated number of elements have been read, regardless of the actual array size, then this attack will fail. The former detects the malformed SOAP message while the latter ensures that the server does not attempt to load more data than was allocated for.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/256.html</p>
<p><strong>Threat</strong>: INP36 - HTTP Response Smuggling</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Design: Employ strict adherence to interpretations of HTTP messages wherever possible.Implementation: Encode header information provided by user input so that user-supplied content is not interpreted by intermediaries.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/273.html</p>
<p><strong>Threat</strong>: INP37 - HTTP Request Smuggling</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: HTTP Request Smuggling is usually targeted at web servers. Therefore, in such cases, careful analysis of the entities must occur during system design prior to deployment. If there are known differences in the way the entities parse HTTP requests, the choice of entities needs consideration.Employing an application firewall can help. However, there are instances of the firewalls being susceptible to HTTP Request Smuggling as well.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/33.html</p>
<p><strong>Threat</strong>: AC16 - Session Credential Falsification through Prediction</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Use a strong source of randomness to generate a session ID.Use adequate length session IDs. Do not use information available to the user in order to generate session ID (e.g., time).Ideas for creating random numbers are offered by Eastlake [RFC1750]. Encrypt the session ID if you expose it to the user. For instance session ID can be stored in a cookie in encrypted format.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/59.html</p>
<p><strong>Threat</strong>: AC17 - Session Hijacking - ServerSide</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: Properly encrypt and sign identity tokens in transit, and use industry standard session key generation mechanisms that utilize high amount of entropy to generate the session key. Many standard web and application servers will perform this task on your behalf. Utilize a session timeout for all sessions. If the user does not explicitly logout, terminate their session after this period of inactivity. If the user logs back in then a new session key should be generated.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/593.html</p>
<h3 id="stripe-payment-service">Stripe Payment Service</h3>
<p><strong>Threat</strong>: INP02 - Overflow Buffers</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: Use a language or compiler that performs automatic bounds checking. Use secure functions not vulnerable to buffer overflow. If you have to use dangerous functions, make sure that you do boundary checking. Compiler-based canary mechanisms such as StackGuard, ProPolice and the Microsoft Visual Studio /GS flag. Unless this provides automatic bounds checking, it is not a complete solution. Use OS-level preventative functionality. Not a complete solution. Utilize static source code analysis tools to identify potential buffer overflow weaknesses in the software.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/100.html, http://cwe.mitre.org/data/definitions/120.html, http://cwe.mitre.org/data/definitions/119.html, http://cwe.mitre.org/data/definitions/680.html</p>
<p><strong>Threat</strong>: AA01 - Authentication Abuse/ByPass</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication and authorization mechanisms. A proven protocol is OAuth 2.0, which enables a third-party application to obtain limited access to an API.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/114.html, http://cwe.mitre.org/data/definitions/287.html</p>
<p><strong>Threat</strong>: DE02 - Double Encoding</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Assume all input is malicious. Create a white list that defines all valid input to the software system based on the requirements specifications. Input that does not match against the white list should not be permitted to enter into the system. Test your decoding process against malicious input. Be aware of the threat of alternative method of data encoding and obfuscation technique such as IP address encoding. When client input is required from web-based forms, avoid using the GET method to submit data, as the method causes the form data to be appended to the URL and is easily manipulated. Instead, use the POST method whenever possible. Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process.Refer to the RFCs to safely decode URL. Regular expression can be used to match safe URL patterns. However, that may discard valid URL requests if the regular expression is too restrictive. There are tools to scan HTTP requests to the server for valid URL such as URLScan from Microsoft (http://www.microsoft.com/technet/security/tools/urlscan.mspx).</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/120.html, http://cwe.mitre.org/data/definitions/173.html, http://cwe.mitre.org/data/definitions/177.html</p>
<p><strong>Threat</strong>: AC01 - Privilege Abuse</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication and authorization mechanisms. A proven protocol is OAuth 2.0, which enables a third-party application to obtain limited access to an API.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/122.html, http://cwe.mitre.org/data/definitions/732.html, http://cwe.mitre.org/data/definitions/269.html</p>
<p><strong>Threat</strong>: INP07 - Buffer Manipulation</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: To help protect an application from buffer manipulation attacks, a number of potential mitigations can be leveraged. Before starting the development of the application, consider using a code language (e.g., Java) or compiler that limits the ability of developers to act beyond the bounds of a buffer. If the chosen language is susceptible to buffer related issues (e.g., C) then consider using secure functions instead of those vulnerable to buffer manipulations. If a potentially dangerous function must be used, make sure that proper boundary checking is performed. Additionally, there are often a number of compiler-based mechanisms (e.g., StackGuard, ProPolice and the Microsoft Visual Studio /GS flag) that can help identify and protect against potential buffer issues. Finally, there may be operating system level preventative functionality that can be applied.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/123.html, http://cwe.mitre.org/data/definitions/119.html</p>
<p><strong>Threat</strong>: DO01 - Flooding</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Ensure that protocols have specific limits of scale configured. Specify expectations for capabilities and dictate which behaviors are acceptable when resource allocation reaches limits. Uniformly throttle all requests in order to make it more difficult to consume resources more quickly than they can again be freed.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/125.html, http://cwe.mitre.org/data/definitions/404.html, http://cwe.mitre.org/data/definitions/770.html</p>
<p><strong>Threat</strong>: DO02 - Excessive Allocation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Limit the amount of resources that are accessible to unprivileged users. Assume all input is malicious. Consider all potentially relevant properties when validating input. Consider uniformly throttling all requests in order to make it more difficult to consume resources more quickly than they can again be freed. Use resource-limiting settings, if possible.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/130.html, http://cwe.mitre.org/data/definitions/770.html, http://cwe.mitre.org/data/definitions/404.html</p>
<p><strong>Threat</strong>: INP08 - Format String Injection</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Limit the usage of formatting string functions. Strong input validation - All user-controllable input must be validated and filtered for illegal formatting characters.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/135.html, http://cwe.mitre.org/data/definitions/134.html, http://cwe.mitre.org/data/definitions/133.html</p>
<p><strong>Threat</strong>: INP12 - Client-side Injection-induced Buffer Overflow</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: The client software should not install untrusted code from a non-authenticated server. The client software should have the latest patches and should be audited for vulnerabilities before being used to communicate with potentially hostile servers. Perform input validation for length of buffer inputs. Use a language or compiler that performs automatic bounds checking. Use an abstraction library to abstract away risky APIs. Not a complete solution. Compiler-based canary mechanisms such as StackGuard, ProPolice and the Microsoft Visual Studio /GS flag. Unless this provides automatic bounds checking, it is not a complete solution. Ensure all buffer uses are consistently bounds-checked. Use OS-level preventative functionality. Not a complete solution.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/14.html, http://cwe.mitre.org/data/definitions/74.html, http://cwe.mitre.org/data/definitions/353.html</p>
<p><strong>Threat</strong>: AC05 - Content Spoofing</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Validation of user input for type, length, data-range, format, etc. Encoding any user input that will be output by the web application.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/148.html, http://cwe.mitre.org/data/definitions/345.html</p>
<p><strong>Threat</strong>: INP13 - Command Delimiters</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: Perform whitelist validation against a positive specification for command length, type, and parameters.Design: Limit program privileges, so if commands circumvent program input validation or filter routines then commands do not running under a privileged accountImplementation: Perform input validation for all remote content.Implementation: Use type conversions such as JDBC prepared statements.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/15.html, http://cwe.mitre.org/data/definitions/146.html, http://cwe.mitre.org/data/definitions/77.html, http://cwe.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/154.html</p>
<p><strong>Threat</strong>: INP14 - Input Data Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Validation of user input for type, length, data-range, format, etc.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/153.html, http://cwe.mitre.org/data/definitions/20.html</p>
<p><strong>Threat</strong>: CR03 - Dictionary-based Password Attack</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Create a strong password policy and ensure that your system enforces this policy.Implement an intelligent password throttling mechanism. Care must be taken to assure that these mechanisms do not excessively enable account lockout attacks such as CAPEC-02.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/16.html, http://cwe.mitre.org/data/definitions/521.html, http://cwe.mitre.org/data/definitions/262.html, http://cwe.mitre.org/data/definitions/263.html</p>
<p><strong>Threat</strong>: AA02 - Principal Spoof</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Employ robust authentication processes (e.g., multi-factor authentication).</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/195.html</p>
<p><strong>Threat</strong>: INP20 - iFrame Overlay</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Configuration: Disable iFrames in the Web browser.Operation: When maintaining an authenticated session with a privileged target system, do not use the same browser to navigate to unfamiliar sites to perform other activities. Finish working with the target system and logout first before proceeding to other tasks.Operation: If using the Firefox browser, use the NoScript plug-in that will help forbid iFrames.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/222.html, http://cwe.mitre.org/data/definitions/1021.html</p>
<p><strong>Threat</strong>: INP23 - File Content Injection</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: Design: Enforce principle of least privilegeDesign: Validate all input for content including files. Ensure that if files and remote content must be accepted that once accepted, they are placed in a sandbox type location so that lower assurance clients cannot write up to higher assurance processes (like Web server processes for example)Design: Execute programs with constrained privileges, so parent process does not open up further vulnerabilities. Ensure that all directories, temporary directories and files, and memory are executing with limited privileges to protect against remote execution.Design: Proxy communication to host, so that communications are terminated at the proxy, sanitizing the requests before forwarding to server host.Implementation: Virus scanning on hostImplementation: Host integrity monitoring for critical files, directories, and processes. The goal of host integrity monitoring is to be aware when a security issue has occurred so that incident response and other forensic activities can begin.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/23.html, http://cwe.mitre.org/data/definitions/20.html</p>
<p><strong>Threat</strong>: AC12 - Privilege Escalation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software. Follow the principle of least privilege when assigning access rights to entities in a software system. Implement separation of privilege - Require multiple conditions to be met before permitting access to a system resource.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/233.html, http://cwe.mitre.org/data/definitions/269.html</p>
<p><strong>Threat</strong>: AC13 - Hijacking a privileged process</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software. Follow the principle of least privilege when assigning access rights to entities in a software system. Implement separation of privilege - Require multiple conditions to be met before permitting access to a system resource.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/234.html, http://cwe.mitre.org/data/definitions/732.html, http://cwe.mitre.org/data/definitions/648.html</p>
<p><strong>Threat</strong>: AC14 - Catching exception throw/signal from privileged block</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: Application Architects must be careful to design callback, signal, and similar asynchronous constructs such that they shed excess privilege prior to handing control to user-written (thus untrusted) code.Application Architects must be careful to design privileged code blocks such that upon return (successful, failed, or unpredicted) that privilege is shed prior to leaving the block/scope.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/236.html, http://cwe.mitre.org/data/definitions/270.html</p>
<p><strong>Threat</strong>: INP24 - Filter Failure through Buffer Overflow</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Make sure that ANY failure occurring in the filtering or input validation routine is properly handled and that offending input is NOT allowed to go through. Basically make sure that the vault is closed when failure occurs.Pre-design: Use a language or compiler that performs automatic bounds checking.Pre-design through Build: Compiler-based canary mechanisms such as StackGuard, ProPolice and the Microsoft Visual Studio /GS flag. Unless this provides automatic bounds checking, it is not a complete solution.Operational: Use OS-level preventative functionality. Not a complete solution.Design: Use an abstraction library to abstract away risky APIs. Not a complete solution.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/24.html, http://cwe.mitre.org/data/definitions/120.html, http://cwe.mitre.org/data/definitions/680.html, http://cwe.mitre.org/data/definitions/20.html</p>
<p><strong>Threat</strong>: INP25 - Resource Injection</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Ensure all input content that is delivered to client is sanitized against an acceptable content specification.Perform input validation for all content.Enforce regular patching of software.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/240.html, https://capec.mitre.org/data/definitions/240.html</p>
<p><strong>Threat</strong>: INP26 - Code Injection</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Utilize strict type, character, and encoding enforcementEnsure all input content that is delivered to client is sanitized against an acceptable content specification.Perform input validation for all content.Enforce regular patching of software.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/242.html, http://cwe.mitre.org/data/definitions/94.html</p>
<p><strong>Threat</strong>: INP27 - XSS Targeting HTML Attributes</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Design: Use libraries and templates that minimize unfiltered input.Implementation: Normalize, filter and white list all input including that which is not expected to have any scripting content.Implementation: The victim should configure the browser to minimize active content from untrusted sources.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/243.html</p>
<p><strong>Threat</strong>: INP28 - XSS Targeting URI Placeholders</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: Use browser technologies that do not allow client side scripting.Design: Utilize strict type, character, and encoding enforcement.Implementation: Ensure all content that is delivered to client is sanitized against an acceptable content specification.Implementation: Ensure all content coming from the client is using the same encoding; if not, the server-side application must canonicalize the data before applying any filtering.Implementation: Perform input validation for all remote content, including remote and user-generated contentImplementation: Perform output validation for all remote content.Implementation: Disable scripting languages such as JavaScript in browserImplementation: Patching software. There are many attack vectors for XSS on the client side and the server side. Many vulnerabilities are fixed in service packs for browser, web servers, and plug in technologies, staying current on patch release that deal with XSS countermeasures mitigates this.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/244.html, http://cwe.mitre.org/data/definitions/83.html</p>
<p><strong>Threat</strong>: INP29 - XSS Using Doubled Characters</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Design: Use libraries and templates that minimize unfiltered input.Implementation: Normalize, filter and sanitize all user supplied fields.Implementation: The victim should configure the browser to minimize active content from untrusted sources.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/245.html</p>
<p><strong>Threat</strong>: INP30 - XSS Using Invalid Characters</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Design: Use libraries and templates that minimize unfiltered input.Implementation: Normalize, filter and white list any input that will be included in any subsequent web pages or back end operations.Implementation: The victim should configure the browser to minimize active content from untrusted sources.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/247.html, https://cwe.mitre.org/data/definitions/86.html</p>
<p><strong>Threat</strong>: INP31 - Command Injection</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: All user-controllable input should be validated and filtered for potentially unwanted characters. Whitelisting input is desired, but if a blacklisting approach is necessary, then focusing on command related terms and delimiters is necessary.Input should be encoded prior to use in commands to make sure command related characters are not treated as part of the command. For example, quotation characters may need to be encoded so that the application does not treat the quotation as a delimiter.Input should be parameterized, or restricted to data sections of a command, thus removing the chance that the input will be treated as part of the command itself.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/248.html</p>
<p><strong>Threat</strong>: INP32 - XML Injection</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Strong input validation - All user-controllable input must be validated and filtered for illegal characters as well as content that can be interpreted in the context of an XML data or a query. Use of custom error pages - Attackers can glean information about the nature of queries from descriptive error messages. Input validation must be coupled with customized error pages that inform about an error without disclosing information about the database or application.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/250.html</p>
<p><strong>Threat</strong>: INP33 - Remote Code Inclusion</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Minimize attacks by input validation and sanitization of any user data that will be used by the target application to locate a remote file to be included.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/253.html</p>
<p><strong>Threat</strong>: INP35 - Leverage Alternate Encoding</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Assume all input might use an improper representation. Use canonicalized data inside the application; all data must be converted into the representation used inside the application (UTF-8, UTF-16, etc.)Assume all input is malicious. Create a white list that defines all valid input to the software system based on the requirements specifications. Input that does not match against the white list should not be permitted to enter into the system. Test your decoding process against malicious input.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/267.html</p>
<p><strong>Threat</strong>: AC15 - Schema Poisoning</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: Protect the schema against unauthorized modification.Implementation: For applications that use a known schema, use a local copy or a known good repository instead of the schema reference supplied in the schema document.Implementation: For applications that leverage remote schemas, use the HTTPS protocol to prevent modification of traffic in transit and to avoid unauthorized modification.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/271.html</p>
<p><strong>Threat</strong>: AC18 - Session Hijacking - ClientSide</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: Properly encrypt and sign identity tokens in transit, and use industry standard session key generation mechanisms that utilize high amount of entropy to generate the session key. Many standard web and application servers will perform this task on your behalf. Utilize a session timeout for all sessions. If the user does not explicitly logout, terminate their session after this period of inactivity. If the user logs back in then a new session key should be generated.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/593.html</p>
<p><strong>Threat</strong>: INP41 - Argument Injection</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Design: Do not program input values directly on command shell, instead treat user input as guilty until proven innocent. Build a function that takes user input and converts it to applications specific types and values, stripping or filtering out all unauthorized commands and characters in the process.Design: Limit program privileges, so if metacharacters or other methods circumvent program input validation routines and shell access is attained then it is not running under a privileged account. chroot jails create a sandbox for the application to execute in, making it more difficult for an attacker to elevate privilege even in the case that a compromise has occurred.Implementation: Implement an audit log that is written to a separate host, in the event of a compromise the audit log may be able to provide evidence and details of the compromise.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/6.html</p>
<p><strong>Threat</strong>: AC20 - Reusing Session IDs (aka Session Replay) - ClientSide</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Always invalidate a session ID after the user logout.Setup a session time out for the session IDs.Protect the communication between the client and server. For instance it is best practice to use SSL to mitigate man in the middle attack.Do not code send session ID with GET method, otherwise the session ID will be copied to the URL. In general avoid writing session IDs in the URLs. URLs can get logged in log files, which are vulnerable to an attacker.Encrypt the session data associated with the session ID.Use multifactor authentication.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/60.html</p>
<p><strong>Threat</strong>: AC21 - Cross Site Request Forgery</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: Use cryptographic tokens to associate a request with a specific action. The token can be regenerated at every request so that if a request with an invalid token is encountered, it can be reliably discarded. The token is considered invalid if it arrived with a request other than the action it was supposed to be associated with.Although less reliable, the use of the optional HTTP Referrer header can also be used to determine whether an incoming request was actually one that the user is authorized for, in the current context.Additionally, the user can also be prompted to confirm an action every time an action concerning potentially sensitive data is invoked. This way, even if the attacker manages to get the user to click on a malicious link and request the desired action, the user has a chance to recover by denying confirmation. This solution is also implicitly tied to using a second factor of authentication before performing such actions.In general, every request must be checked for the appropriate authentication token as well as authorization in the current session context.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/62.html</p>
<h3 id="customer-logs-into-the-merchant-site">Customer logs into the merchant site (*)</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="customer-proceeds-to-payment-page-to-make-a-purchase">Customer proceeds to payment page to make a purchase (*)</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="customer-client-sends-order-intent-including-order-amount">Customer Client sends order intent, including order amount (*)</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="merchant-sends-order-information-inc-amount-and-currency">Merchant sends order information inc amount and currency (*)</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="return-paymentintent-to-the-merchant">Return PaymentIntent to the Merchant (*)</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="return-paymentintent-to-the-customer-client">Return PaymentIntent to the Customer Client (*)</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="customer-provides-card-details-and-finalizes-payment">Customer provides card details and finalizes payment (*)</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="customer-client-sends-stripe.confirmcardpayment">Customer Client sends stripe.confirmCardPayment() (*)</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="attempt-payment">Attempt payment</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="payment-response">Payment Response</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
<h3 id="return-the-paymentintent-with-status">Return the PaymentIntent with status (*)</h3>
<p><strong>Threat</strong>: DE01 - Interception</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Leverage encryption to encode the transmission of data thus making it accessible only to authorized parties.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/117.html, http://cwe.mitre.org/data/definitions/319.html</p>
<p><strong>Threat</strong>: DE03 - Sniffing Attacks</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Encrypt sensitive information when transmitted on insecure mediums to prevent interception.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/157.html, http://cwe.mitre.org/data/definitions/311.html</p>
<p><strong>Threat</strong>: CR06 - Communication Channel Manipulation</p>
<p><strong>Severity</strong>: High</p>
<p><strong>Mitigations</strong>: Encrypt all sensitive communications using properly-configured cryptography.Design the communication system such that it associates proper authentication/authorization with each channel/message.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/216.html</p>
<p><strong>Threat</strong>: CR08 - Client-Server Protocol Manipulation</p>
<p><strong>Severity</strong>: Medium</p>
<p><strong>Mitigations</strong>: Use strong authentication protocols.</p>
<p><strong>References</strong>: https://capec.mitre.org/data/definitions/220.html, http://cwe.mitre.org/data/definitions/757.html</p>
<p><strong>Threat</strong>: DS06 - Data Leak</p>
<p><strong>Severity</strong>: Very High</p>
<p><strong>Mitigations</strong>: All data should be encrypted in transit. All PII and restricted data must be encrypted at rest. If a service is storing credentials used to authenticate users or incoming connections, it must only store hashes of them created using cryptographic functions, so it is only possible to compare them against user input, without fully decoding them. If a client is storing credentials in either files or other data store, access to them must be as restrictive as possible, including using proper file permissions, database users with restricted access or separate storage.</p>
<p><strong>References</strong>: https://cwe.mitre.org/data/definitions/311.html, https://cwe.mitre.org/data/definitions/312.html, https://cwe.mitre.org/data/definitions/916.html, https://cwe.mitre.org/data/definitions/653.html</p>
